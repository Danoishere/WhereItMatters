@model DonationRequest
@{
    ViewData["Title"] = Model.Title;
}

<br />
<div class="col-sm-8">
    <div style="width:100%;max-height:300px;overflow: hidden;border-radius:6px;border:2px solid #bdc3c7">
        <img style="width:100%" src="~/images/requestimages/@Model.ImageUrl" />
    </div>

    <div class="row">
        <div class="col-sm-12">
            <h2>@Model.Title</h2>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <p class="text-md text-italic" style="">«@Model.ShortSummary»</p>
        </div>
    </div>
    @if (!Model.IsFinanced && !Model.IsFinished)
    {
        <br />
        <form method="get" class="input-group input-group-lg pull-left" style="width:400px" asp-action="DonationDetails" asp-controller="Donation">
            <span class="input-group-addon">$</span>
            <input name="amount" class="form-control text-right" placeholder="30.0" type="number" min="0.00" step="0.05" style="width:110px;margin-right:5px;height:50px" />
            <input name="requestId" type="hidden" value="@Model.Id" />
            <input type="submit" class="btn btn-primary btn-lg" value="Donate" />
        </form>
        <div class="pull-right">
            <p class="text-md">@Model.DaysUntilEnd days until campaign end</p>
        </div>

        <br />
    }
    // The campaign was not successful.
    else if (Model.IsFinished && !Model.IsFinanced)
    {
        <br />
        <div class="thumbnail">
            <h4>Unfortunately, the campaign could not be finished.</h4>
            <p>The donated money will be paid back to the donors.</p>
        </div>
        <br />
    }
    // The campaign was successful
    else if (Model.IsFinanced)
    {
        <br />
        <h4>The campaign has been sucessfully finished</h4>
        <br />
    }

    @if (Model.IsFinished && !Model.IsFinanced) { }
    else
    {
        <div style="display:inline-block;width:100%">
            @if (!Model.IsFinanced && !Model.IsFinished)
            {
                <h3 class="center-block">@PaymentConfig.CurrencyShort@Model.RemainingUSDNeeded still needed</h3>
            }
            else
            {
                <h3 class="center-block">Successfully financed</h3>
            }
        </div>
        @await Component.InvokeAsync("ProgressBar", new { maxValue = Model.NeededAmountUSD, currentValue = Model.Donated })
    }


    <br />
    <div class="row">
        <div class="col-sm-12">
            <p class="text-md">@Model.Description</p>
        </div>
    </div>

</div>
<div class="col-sm-4">
    <div class="thumbnail" style="padding:20px">
        <div class="row">
            <div class="col-sm-12">
                <h3>Collected Donations</h3>
            </div>
        </div>
        <br />
        @foreach (var donation in Model.Donations)
        {
            <div class="row" style="height:30px">
                <div class="col-sm-12">
                    @if (donation.ShowInDonationLog)
                    {
                        <b class="text-md pull-left">@donation.DonorName,   </b>
                    }
                    else
                    {
                        <b class="text-md pull-left">Anonymous,   </b>
                    }
                    <p class="text-sm pull-left">@donation.TimeStamp.ToString("MM/dd/yyyy")</p>
                    <p class="text-md pull-right" style="margin-bottom:0">$@donation.AmountUSD</p>
                </div>
            </div>
            @if (!string.IsNullOrEmpty(donation.Comment))
            {
                <div class="row">
                    <div class="col-sm-12">
                        <p class="text-sm text-italic">"@donation.Comment"</p>
                    </div>
                </div>
            }
            <div class="seperator"></div>
        }
    </div>
</div>